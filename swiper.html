<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      html,
      body {
        margin: 0;
        width: 100%;
        height: 100%;
      }

      .container {
        width: 100%; /* 컨테이너의 너비를 100%로 설정하여 화면 전체 너비를 차지 */
        height: 100%; /* 컨테이너의 높이를 800px로 지정 */
        display: flex; /* 내부 요소를 가로로 배치하는 flex 컨테이너로 설정 */
        justify-content: center; /* 내부 요소를 수평 방향 가운데 정렬 */
        align-items: center; /* 내부 요소를 수직 방향 가운데 정렬 */
        position: relative; /* 자식 요소들의 절대 위치(relative) 기준점이 됨 */
        transform: rotateX(-10deg); /* 컨테이너를 X축 기준으로 -10도 회전 */
        transform-style: preserve-3d; /* 3D 변환 요소를 중첩해서 사용 가능하도록 설정 */
        perspective: 2000px; /* 원근감(3D) 거리를 2000px로 설정 */
      }

      .card {
        max-width: 200px; /* 카드의 최대 너비를 200px로 제한 */
        position: absolute; /* 카드를 절대 위치로 배치해 겹쳐진 형태를 구현 */
        backface-visibility: visible; /* 뒤집혔을 때 뒷면이 보이게 설정 */
        transition: transform 1s ease-in-out; /* 변환(회전, 이동) 시 1초간 부드럽게 애니메이션 */
      }

      @media (max-width: 768px) {
        html,
        body {
          overflow: hidden; /* 작은 화면에서 스크롤바를 숨김 */
        }
        .container {
          height: 80vh; /* 모바일 환경에서 컨테이너 높이를 뷰포트 높이의 80%로 설정 */
          perspective: 1500px; /* 3D 원근감을 1500px로 조절 */
          transform: rotateX(-5deg); /* X축으로 -5도 회전 */
        }
        .card {
          width: 100px; /* 모바일 화면에서 카드 너비를 100px로 지정 */
          height: 150px; /* 모바일 화면에서 카드 높이를 150px로 지정 */
          font-size: 20px; /* 텍스트 크기를 20px로 지정 */
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div id="first-card" class="card">
        <strong>1993</strong>
        <span>
          <ul>
            <li>부산 전포동 창립</li>
          </ul>
        </span>
      </div>
      <div id="second-card" class="card">
        <strong>2002</strong>
        <span>
          <ul>
            <li>잠수복 공장 설립</li>
          </ul>
        </span>
      </div>
      <div id="third-card" class="card">
        <strong>2003</strong>
        <span>
          <ul>
            <li>의료용 고압챔버 연구소 설립</li>
          </ul>
        </span>
      </div>
      <div id="fourth-card" class="card">
        <strong>2005</strong>
        <span>
          <ul>
            <li>의료용 고압챔버 제조 설비 구축</li>
          </ul>
        </span>
      </div>
      <div id="fifth-card" class="card">
        <strong>2008</strong>
        <span>
          <ul>
            <li>의료용 고압챔버 국내인증 (GMP)</li>
          </ul>
        </span>
      </div>
      <div id="sixth-card" class="card">
        <strong>2011</strong>
        <span>
          <ul>
            <li>2세대 의료용 고압챔버 개발</li>
          </ul>
        </span>
      </div>
      <div id="seventh-card" class="card">
        <strong>2013</strong>
        <span>
          <ul>
            <li>고압산소치료기(HBOT) 해외수출</li>
          </ul>
        </span>
      </div>
      <div id="eighth-card" class="card">
        <strong>2014</strong>
        <span>
          <ul>
            <li>Monoplace Chamber 2세대 개발</li>
          </ul>
        </span>
      </div>
      <div id="ninth-card" class="card">
        <strong>2015</strong>
        <span>
          <ul>
            <li>기업부설연구소 인정</li>
            <li>자동화 생산설비 및 탱크라인 증설</li>
            <li>Multiple Chamber 2세대 개발</li>
          </ul>
        </span>
      </div>
      <div id="tenth-card" class="card">
        <strong>2016</strong>
        <span>
          <ul>
            <li>기술혁신형 중소기업 (INNO-BIZ) 인증</li>
          </ul>
        </span>
      </div>
      <div id="eleventh-card" class="card">
        <strong>2017</strong>
        <span>
          <ul>
            <li>ISO 9001인증</li>
            <li>세계최초 일인용챔버 고음압챔버 3세대 개발</li>
          </ul>
        </span>
      </div>
      <div id="twelfth-card" class="card">
        <strong>2018</strong>
        <span>
          <ul>
            <li>고압치료솔루션 융합치유센터 설립</li>
            <li>고압산소치료기 해외 23개국 수출</li>
            <li>장비 제작 및 기술지원 전문화 시스템 구축</li>
            <li>부산 남구 신선로 본사 및 공장 이전</li>
            <li>(부산광역시)</li>
            <li>시카고 치과전시회 참가 (CDS Midwinter Meeting)</li>
            <li>WCAS (세계 잠수 학술대회) 참가</li>
            <li>ICA 국제학술대회 참가</li>
          </ul>
        </span>
      </div>
      <div id="thirteenth-card" class="card">
        <strong>2019</strong>
        <span>
          <ul>
            <li>4세대 Hyper Chamber 개발</li>
            <li>국립부산과학관 기업지원 (부산치유재단센터)</li>
            <li>부산시티산업진흥원 기업지원</li>
            <li>스마트시티 혁신성장기업 선정(부산시)</li>
            <li>KIMES (국제의료기기, 병원설비전시회) 참가</li>
          </ul>
        </span>
      </div>
      <div id="fourteenth-card" class="card">
        <strong>2020</strong>
        <span>
          <ul>
            <li>대구경북 지역 지원기업 선정</li>
            <li>다중 챔버 3세대 개발</li>
            <li>세계 35개국 수출</li>
            <li>Monoplace Chamber 3세대 개발</li>
          </ul>
        </span>
      </div>
      <div id="fiveteenth-card" class="card">
        <strong>2021</strong>
        <span>
          <ul>
            <li>Multiple Chamber 4세대 개발</li>
            <li>복합 헬스케어 솔루션 개발</li>
            <li>39개국 수출</li>
          </ul>
        </span>
      </div>
      <div id="sixteenth-card" class="card">
        <strong>2022</strong>
        <span>
          <ul>
            <li>스마트 팩토리 공장 자동화 구축</li>
            <li>KIMES BUSAN 참가</li>
            <li>45개국 수출</li>
          </ul>
        </span>
      </div>
    </div>
    <script>
      const offsetZ = 200; // translateZ 오프셋 값
      const amplitudeX = 550; // X축 이동 범위(진폭)
      const amplitudeY = 300; // Y축 이동 범위(진폭)
      const amplitudeZ = 500; // Z축 이동 범위(진폭)
      const container = document.querySelector(".container"); // 카드를 감싸는 컨테이너 요소

      class Swiper {
        constructor(area, card, mode = "horizontal") {
          this.area = area; // 컨테이너 요r소 참조
          this.card = card; // 카드 선택자를 저장
          this.mode = mode; // 회전 방향 모드 (horizontal / vertical)
          this.width = 0; // 컨테이너 너비
          this.height = 0; // 컨테이너 높이
          this.initialX = 0; // 마우스/터치 시작 X좌표
          this.initialY = 0; // 마우스/터치 시작 Y좌표
          this.hThreshold = 0; // 가로 임계값
          this.vThreshold = 0; // 세로 임계값
          this.isClick = false; // 드래그 중인지 여부
          this.cards = document.querySelectorAll(this.card); // 모든 카드 요소(NodeList)
          this.sequence = Array.from(this.cards).map((card) => card.id); // 카드의 ID 순서를 배열로 저장
        }
        init() {
          this.width = this.area.offsetWidth; // 컨테이너 실제 너비
          this.height = this.area.offsetHeight; // 컨테이너 실제 높이
          this.hThreshold = this.width / this.cards.length; // 가로 방향으로 회전하기 위한 임계값
          this.vThreshold = this.height / this.cards.length; // 세로 방향으로 회전하기 위한 임계값
        }
        setInitalPoint(e) {
          this.initialX = e.clientX; // 처음 클릭/터치 X좌표 저장
          this.initialY = e.clientY; // 처음 클릭/터치 Y좌표 저장
        }
        calculateDistance(e) {
          const deltaX = e.clientX - this.initialX; // X축으로 움직인 거리
          const deltaY = e.clientY - this.initialY; // Y축으로 움직인 거리
          if (Math.abs(deltaX) > Math.abs(deltaY)) {
            return deltaX; // 가로 이동 거리가 더 크면
          } else {
            return deltaY; // 세로 이동 거리가 더 크면
          }
        }
        rotateObject(e) {
          if (!this.isClick) return; // 클릭/터치 중이 아니면 종료
          const delta = this.calculateDistance(e); // 이동 방향과 거리 계산
          const threshold =
            this.mode === "horizontal" ? this.hThreshold : this.vThreshold; // 방향별 임계값
          if (Math.abs(delta) < threshold) {
            return;
          } // 임계값보다 이동이 작으면 회전 없음
          if (delta > 0) {
            this.moveNext(); // 양수면 다음 카드로 이동
          } else {
            this.movePrev(); // 음수면 이전 카드로 이동
          }
          this.isClick = !this.isClick; // 클릭/터치 상태 해제
        }
        shuffle() {
          const cards = document.querySelectorAll(this.card); // 현재 DOM에서 모든 카드 조회
          this.cards.forEach((card) => {
            card.style.transition = "none"; // 위치를 재배치하기 전 트랜지션 끔
          });
          this.sequence.forEach((id) => {
            const card = document.getElementById(id); // 순서 배열에 있는 ID에 해당하는 카드
            if (card) {
              this.area.appendChild(card); // 컨테이너의 맨 뒤로 순서대로 붙임
            }
          });
          this.area.offsetWidth; // 리플로우 강제 발생 (재배치 후 적용)
          cards.forEach((card) => {
            card.style.transition = ""; // 트랜지션 다시 켬
          });
          cards.forEach((card, index) => {
            // index를 이용해 회전 각도 계산
            const angleDeg = index * (360 / this.cards.length); // 전체 카드를 원형으로 배치하기 위한 각도
            const angleRad = (angleDeg * Math.PI) / 180; // 라디안 변환
            const translateZ = amplitudeZ * Math.cos(angleRad) + offsetZ; // Z축 이동 거리
            // 회전 + 3D 위치 설정
            if (this.mode === "horizontal") {
              const translateX = amplitudeX * Math.sin(angleRad); // X축 이동 거리
              card.style.transform = `translateX(${translateX}px) translateZ(${translateZ}px) rotateY(${angleDeg}deg)`;
            } else {
              const translateY = amplitudeY * Math.sin(angleRad); // Y축 이동 거리
              card.style.transform = `translateY(${translateY}px) translateZ(${translateZ}px) rotateX(${angleDeg}deg)`;
            }
          });
        }
        movePrev() {
          const value = this.sequence.pop(); // 배열의 마지막 ID를 꺼냄
          this.sequence.unshift(value); // 맨 앞에 추가하여 순서 재조정
          this.shuffle(); // 새 순서대로 다시 배치
        }
        moveNext() {
          const value = this.sequence.shift(); // 배열의 첫 번째 ID를 꺼냄
          this.sequence.push(value); // 맨 뒤에 추가하여 순서 재조정
          this.shuffle(); // 새 순서대로 다시 배치
        }
      }

      const swiper = new Swiper(container, ".card", "horizontal"); // Swiper 인스턴스 생성
      swiper.init(); // 초기화 작업 수행

      container.addEventListener("mousedown", (e) => {
        swiper.isClick = true; // 드래그 시작 상태로 전환
        swiper.setInitalPoint(e); // 드래그 시작 위치 설정
      });

      container.addEventListener("touchstart", (e) => {
        swiper.isClick = true; // 터치 시작 상태로 전환
        swiper.setInitalPoint(e.touches[0]); // 터치 시작 위치 설정
      });

      container.addEventListener("mousemove", (e) => {
        swiper.rotateObject(e); // 마우스 이동에 따라 회전 검사
      });

      container.addEventListener("touchmove", (e) => {
        swiper.rotateObject(e.touches[0]); // 터치 이동에 따라 회전 검사
      });

      container.addEventListener("mouseup", (e) => {
        swiper.isClick = false; // 드래그 해제
      });

      container.addEventListener("touchend", (e) => {
        swiper.isClick = false; // 터치 해제
      });

      swiper.moveNext(); // 첫 번째 이동 실행
      setInterval(() => swiper.moveNext(), 1500); // 1.5초 간격으로 자동 이동
    </script>
  </body>
</html>
